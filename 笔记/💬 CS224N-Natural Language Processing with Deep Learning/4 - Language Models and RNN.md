# Language Models and RNN
## è®­ç»ƒTrick

è¿™é‡Œçš„å†…å®¹æ˜¯è®²ä¸€äº›å…‹æœè¿‡æ‹Ÿåˆçš„trickçš„ï¼Œä½†OpenAIçš„ç»“æœæ˜¾ç¤ºï¼Œå…¶å®ä¸å­˜åœ¨æ‰€è°“çš„è¿‡æ‹Ÿåˆï¼Œå­˜åœ¨double descentã€‚æˆ‘åœ¨é‡Œé¢ä¹Ÿè®¨è®ºäº†ä¸‹é¢trickçš„å†…å®¹ã€‚
è®ºæ–‡é“¾æ¥ï¼š https://arxiv.org/abs/1912.02292
è€Œè¿™ç¯‡paperæˆ‘å·²ç»åšè¿‡è§£è¯»ï¼Œå¯ä»¥å‚è€ƒï¼š [Deep Double Descent Where Bigger Models and More Data Hurt](../ğŸ§%20è¯»è¯»paper/Deep%20Double%20Descent%20Where%20Bigger%20Models%20and%20More%20Data%20Hurt.md)  
### ä½¿ç”¨æ­£åˆ™åŒ–åº”å¯¹è¿‡æ‹Ÿåˆ
$$J(\theta)=\frac{1}{N}\sum_{i=1}^{N}-\log\left(\frac{e^{f_{y_i}}}{\sum_{c=1}^{C}e^{f_c}}\right)\boxed{+\lambda\sum_{k}\theta_k^2}$$
**ç»å…¸è§‚ç‚¹ï¼š**
è¿™ä¸ªæ˜¯L2æ­£åˆ™ã€‚L2æ­£åˆ™çš„åŸç†å°±æ˜¯ï¼Œå½“æˆ‘ä»¬å»argmin theta Jçš„æ—¶å€™ï¼Œå‰åŠéƒ¨åˆ†ç¼©å°æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ååŠéƒ¨åˆ†çš„æ­£åˆ™é¡¹ï¼Œå¦‚æœæƒ³è¦å°ï¼Œé‚£ä¹ˆæ¯ä¸ªthetaéƒ½ä¸èƒ½å¤ªå¤§ï¼Œè¿™å°±ä¼šè®©thetaæ•´ä½“è¶‹äºå°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®©æŸä¸ªç¥ç»å…ƒè¿‡äºæ•æ„Ÿï¼Œä»è€Œé˜²æ­¢è¿‡æ‹Ÿåˆçš„å‘ç”Ÿã€‚

**ç›®å‰è§‚ç‚¹ï¼š**

> [!warning] âš ï¸ è¿‡æ‹Ÿåˆçš„å¥‡æ€ªè¡¨è¿°
è¿™é‡Œæœ‰ä¸ªå¾ˆæ€ªçš„è¯´æ³•ï¼Œslideè®¤ä¸ºè®­ç»ƒé›†çš„è¯¯å·®æ¥è¿‘0å°±å«è¿‡æ‹Ÿåˆï¼Œæˆ‘è®¤ä¸ºä¸æ˜¯ï¼Œæˆ‘è®¤ä¸ºè¿‡æ‹Ÿåˆæ˜¯ä¸€ä¸ªç›¸å¯¹æ¦‚å¿µï¼Œtrainé™testå‡æ‰å«è¿‡æ‹Ÿåˆï¼Œå•çœ‹trainé™åˆ°0ä¹Ÿä¸èƒ½å«è¿‡æ‹Ÿåˆï¼Œä½†æ˜¯ä¸ºäº†å±•ç¤ºè¿™ä¸ªè§‚ç‚¹ï¼Œæˆ‘æŠŠè§‚ç‚¹æ”¾åœ¨è¿™ã€‚

ç›®å‰è§‚ç‚¹è®¤ä¸ºï¼Œæ­£åˆ™åŒ–åªæ˜¯å¢åŠ æ¨¡å‹çš„æ³›åŒ–æ€§ï¼Œå’Œè¿‡æ‹Ÿåˆæ²¡å…³ç³»ï¼Œå³ä½¿ä½ ç–¯ç‹‚è¿‡æ‹Ÿåˆï¼ˆè¿™é‡ŒæŒ‡train lossæ¥è¿‘0ï¼‰ï¼Œä½ çš„testä¹Ÿå¯ä»¥é™ï¼Œå› ä¸ºä½ å®¶äº†æ­£åˆ™ã€‚
ä¸‹é¢çš„å›¾ï¼Œæ¨ªè½´æ˜¯æ¨¡å‹è§„æ¨¡ã€‚

![](assets/Pasted%20image%2020241120070209.webp)


### ä½¿ç”¨Dropoutåº”å¯¹è¿‡æ‹Ÿåˆ
è®­ç»ƒæ—¶æŒ‰ç…§pçš„æ¦‚ç‡ä½¿å¾—ç¥ç»å…ƒè¾“å…¥ä¸º0ï¼Œæµ‹è¯•æ—¶è¾“å‡ºä¹˜ä»¥1-pã€‚æœ€åä¹˜1-pæ˜¯å› ä¸ºpæ˜¯dropçš„æ¦‚ç‡ï¼Œæ‰€ä»¥1-på°±æ˜¯ä¸dropï¼Œä¹Ÿå°±æ˜¯æœŸæœ›ã€‚
![](assets/Pasted%20image%2020241120071517.webp)
è¿™ç§æ¯æ¬¡å±è”½ä¸€éƒ¨åˆ†ç¥ç»å…ƒçš„æ–¹æ³•ï¼Œå¯ä»¥é¿å…æ¨¡å‹ä¸­ç¥ç»å…ƒå…±é€‚åº”(co adaptation)
ä¸ºä»€ä¹ˆdropoutæœ‰æ•ˆå‘¢ï¼ŸåŸå› æ˜¯ï¼Œ
- å¾ˆå¤šæ—¶å€™ç‰¹å¾æ˜¯äº’ç›¸ä¾èµ–çš„ã€‚å¦‚æœæ‰€æœ‰çš„ç¥ç»å…ƒéƒ½æœ‰æ•ˆï¼Œé‚£ä¹ˆç¥ç»å…ƒå¯èƒ½ä¼šè¿‡åº¦ä¾èµ–è¿™ç§å…³ç³»ä»è€Œè¿‡æ‹Ÿåˆã€‚é€šè¿‡éšæœºå±è”½çš„æ–¹æ³•ï¼Œå¯ä»¥è®©ç‰¹å¾ç‹¬ç«‹åœ°å‘æŒ¥ä½œç”¨ï¼Œå‡å°‘å¯¹ä¾èµ–å…³ç³»çš„åˆ©ç”¨ï¼Œä»è€Œå¢å¼ºæ³›åŒ–æ€§ã€‚æ‰€ä»¥dropoutä¹Ÿè¢«çœ‹æˆæ˜¯ç‰¹å¾ä¾èµ–çš„å¼ºæ­£åˆ™åŒ–ã€‚
- å¦ä¸€æ–¹é¢ï¼Œdropoutç›¸å½“äºè®­ç»ƒäº†å¤šä¸ªå­æ¨¡å‹ï¼Œå¹¶è¿›è¡Œäº†é›†æˆï¼Œé™ä½äº†å•ä¸€æ¨¡å‹è¿‡æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„é£é™©
- åœ¨æµ‹è¯•æ—¶é€šè¿‡æƒé‡è°ƒæ•´æ•´åˆå­æ¨¡å‹çš„èƒ½åŠ›ã€‚

### æƒé‡åˆå§‹åŒ–
å¦‚æœæƒé‡å…¨éƒ¨è®¾ç½®ä¸º0ï¼Œé‚£ä¹ˆè¾“å‡ºä¸€æ ·ï¼Œå°±ä¼šå­¦åˆ°ç›¸åŒçš„ç‰¹å¾ã€‚
æ‰€ä»¥å°±ä¼šæœ‰ä¸‹é¢çš„æ–¹æ³•ï¼š
- wéƒ½éšæœºæˆå°éšæœºæ•°
- å¯¹äºéšè—å±‚çš„bï¼Œè®¾ç½®ä¸º0ï¼Œå¯¹äºè¾“å‡ºå±‚ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€å±‚çš„bï¼Œè®¾ç½®æˆç»“æœçš„å¹³å‡å€¼ï¼Œæˆ–è€…avg(sigmoid^-1(ç»“æœ))
- æŠŠæ‰€æœ‰wæŒ‰ç…§uniform(-r, r)ç”Ÿæˆã€‚råˆ«å¤ªå°å¤ªå¤§
- Xavier åˆå§‹åŒ–ç¡®ä¿è¾“å…¥å±‚å’Œè¾“å‡ºå±‚çš„æ¿€æ´»å€¼å…·æœ‰ç›¸åŒçš„æ–¹å·®ï¼Œä»è€Œé¿å…æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ã€‚è¿™æœ‰åŠ©äºå‡ç¼“æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨æ·±å±‚ç½‘ç»œä¸­ã€‚varä¸ºæ–¹å·®ï¼Œnä¸ºç¥ç»å…ƒæ•°é‡ã€‚
$$\mathrm{Var}(W_i)=\frac2{n_\mathrm{in}+n_\mathrm{out}}$$
- éšç€å±‚å½’ä¸€åŒ–Layer Normalizationçš„åº”ç”¨ï¼Œå¯¹è¿™äº›åˆå§‹åŒ–æŠ€å·§çš„éœ€æ±‚å¯èƒ½ä¼šå‡å°‘ã€‚

### Optimizer
å¯¹äºå¤§å¤šæ•°ä¼˜åŒ–å™¨ï¼Œå»ºè®®çš„åˆå§‹å­¦ä¹ ç‡æ˜¯ 0.001ã€‚
- SGD **è¶³å¤Ÿå¥½ç”¨** ï¼Œä½†æ‰‹åŠ¨è°ƒæ•´å­¦ä¹ ç‡å¯¹äºè·å¾—è‰¯å¥½æ•ˆæœè‡³å…³é‡è¦ã€‚å­¦ä¹ ç‡åˆå§‹å€¼å¯ä»¥è®¾ç½®å¾—è¾ƒé«˜ï¼ˆä¾‹å¦‚ 0.1 æˆ– 0.01ï¼‰ã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œæ¯éš” k ä¸ª epoch å°†å­¦ä¹ ç‡å‡åŠï¼Œä»¥åº”å¯¹æŸå¤±å‡½æ•°çš„ä¸‹é™ã€‚
- Adagradèƒ½å¤Ÿè‡ªåŠ¨è°ƒæ•´å‚æ•°çš„å­¦ä¹ ç‡ï¼Œé€‚åˆç¨€ç–ç‰¹å¾é—®é¢˜ã€‚ä½†å®¹æ˜“â€œæ—©åœâ€ï¼ˆstall earlyï¼‰ï¼Œå³åæœŸå­¦ä¹ ç‡ä¼šè¿‡å°ï¼Œå¯¼è‡´è®­ç»ƒåœæ»ã€‚
- RMSpropæ”¹è¿›äº† Adagradï¼Œæ§åˆ¶äº†å­¦ä¹ ç‡çš„è¡°å‡é€Ÿåº¦ï¼Œæ›´é€‚åˆæ·±åº¦å­¦ä¹ ä¸­çš„é•¿æ—¶é—´è®­ç»ƒã€‚
- Adamç»“åˆäº† Adagrad å’Œ RMSprop çš„ä¼˜ç‚¹ï¼Œé€‚åˆå¤§å¤šæ•°ä»»åŠ¡ï¼Œæ˜¯è®¸å¤šåœºæ™¯ä¸‹çš„é»˜è®¤é€‰æ‹©ã€‚
- AdamWè€ƒè™‘äº†æƒé‡è¡°å‡çš„ä¼˜åŒ–ï¼ˆweight decayï¼‰ï¼Œæ›´é€‚åˆå¤§å‹æ¨¡å‹ã€‚
- NAdamWåœ¨ AdamW åŸºç¡€ä¸Šå¼•å…¥äº† Nesterov åŠ¨é‡åŠ é€Ÿï¼Œæ›´é€‚åˆè¯­è¨€æ¨¡å‹ï¼ˆå¦‚è¯å‘é‡ï¼‰å’Œé€Ÿåº¦è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚

## Language Model
### Intro
æ€»çš„æ¥è¯´ï¼ŒLanguage Modelæ˜¯ä¸€ç§é¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ˜¯ä»€ä¹ˆçš„æ¨¡å‹ã€‚
![](assets/Pasted%20image%2020241120143356.webp)
å¦‚æœæ›´æ­£å¼çš„å†™ï¼Œå°±æ˜¯è¿™æ ·ï¼š
$$P(\boldsymbol{x}^{(t+1)}|\boldsymbol{x}^{(t)},\ldots,\boldsymbol{x}^{(1)})$$
xtæ˜¯å‰é¢çš„è¯ï¼Œè€Œxt+1å¯ä»¥æ˜¯è¯­æ–™åº“Vé‡Œé¢çš„ä»»ä½•ä¸€ä¸ªè¯ã€‚
è¯­è¨€æ¨¡å‹ä¹Ÿå¯ä»¥è¿™æ ·è§£é‡Šï¼šLMæ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå¯ä»¥ä¸ºä¸€å¥è¯åˆ†é…æ¦‚ç‡ã€‚
ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€å¥è¯x1 ... xT, é‚£ä¹ˆè¿™å¥è¯çš„æ¦‚ç‡å°±æ˜¯ï¼š
$$\begin{aligned}P(\boldsymbol{x}^{(1)},\ldots,\boldsymbol{x}^{(T)})&=P(\boldsymbol{x}^{(1)})\times P(\boldsymbol{x}^{(2)}|\boldsymbol{x}^{(1)})\times\cdots\times P(\boldsymbol{x}^{(T)}|\boldsymbol{x}^{(T-1)},\ldots,\boldsymbol{x}^{(1)})\\&=\prod_{t=1}^TP(\boldsymbol{x}^{(t)}|\boldsymbol{x}^{(t-1)},\ldots,\boldsymbol{x}^{(1)})\end{aligned}$$
è€Œè¿™å°±æ˜¯LMçš„æ ¸å¿ƒåŠŸèƒ½ã€‚ä½ é€šè¿‡æ¡ä»¶æ¦‚ç‡çš„é“¾å¼æ³•åˆ™æŠŠä¸€ä¸ªæ¦‚ç‡æ‹†è§£æˆä¸‹é¢çš„è”ä¹˜å½¢å¼åï¼Œè¯­è¨€æ¨¡å‹çš„ä½œç”¨å°±ä½“ç°åœ¨ç»™å®šå‰é¢çš„è¯x1 - xt-1, é¢„æµ‹xtçš„æ¦‚ç‡ã€‚

è¿™é‡Œå°±æ˜¯LMçš„ä¸€ä¸ªåº”ç”¨ï¼š
![](assets/Pasted%20image%2020241121202140.webp)


### n-gram Language Model

n-gram LM æ˜¯åœ¨DLå‡ºç°ä¹‹å‰æœ€å¸¸ç”¨çš„ä¸€ç§è¯­è¨€æ¨¡å‹ã€‚ n-gramæ˜¯ç”± **n ä¸ªè¿ç»­å•è¯** ç»„æˆçš„å•è¯å—ã€‚
ä¾‹å¦‚å¥å­The students opened their \_\_\_\_\_
1-gram: â€œtheâ€, â€œstudentsâ€, â€œopenedâ€, â€œtheirâ€
2-gram: â€œthe studentsâ€, â€œstudents openedâ€, â€œopened theirâ€
3-gram: â€œthe students openedâ€, â€œstudents opened theirâ€
4-gram: â€œthe students opened theirâ€

æƒ³æ³•å°±æ˜¯ï¼Œæ”¶é›†å…³äºä¸åŒn-gramçš„é¢‘ç‡ç»Ÿè®¡æ•°æ®ï¼Œå¹¶åˆ©ç”¨è¿™äº›æ•°æ®æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯ã€‚

n-gramæœ‰ä¸€ä¸ªå‡è®¾ï¼Œå«åšMarkov assumption: æ¯ä¸ªå•è¯ x(t+1)çš„å‡ºç°åªä¾èµ–äºå‰é¢ nâˆ’1ä¸ªå•è¯ï¼Œè€Œä¸ä¾èµ–æ›´ä¹…è¿œçš„ä¸Šä¸‹æ–‡ã€‚næ˜¯n-gramçš„n
$$P(x^{(t+1)}|x^{(t)},x^{(t-1)},\ldots,x^{(1)})=P(x^{(t+1)}|x^{(t)},x^{(t-1)},\ldots,x^{(t-n+2)})$$
è€Œæ ¹æ®æ¡ä»¶æ¦‚ç‡çš„å…¬å¼ï¼Œæˆ‘ä»¬æœ‰ï¼š
$$P(x^{(t+1)}|x^{(t)},x^{(t-1)},\ldots,x^{(t-n+2)})=\frac{P(x^{(t+1)},x^{(t)},\ldots,x^{(t-n+2)})}{P(x^{(t)},x^{(t-1)},\ldots,x^{(t-n+2)})}$$
é‚£æˆ‘ä»¬æ€ä¹ˆå¾—åˆ°n-gramå’Œ(n-1)-gramçš„è”åˆæ¦‚ç‡å‘¢ï¼Ÿç”¨å¤§å‹è¯­æ–™åº“ä¸­çš„**é¢‘ç‡ä¼°è®¡æ¦‚ç‡**ï¼š
$$P(x^{(t+1)}|x^{(t)},\ldots,x^{(t-n+2)})\approx\frac{\mathrm{count}(x^{(t+1)},x^{(t)},\ldots,x^{(t-n+2)})}{\mathrm{count}(x^{(t)},x^{(t-1)},\ldots,x^{(t-n+2)})}$$
ä¾‹å­ï¼š
![](assets/Pasted%20image%2020241121203208.webp)
é‚£ä¹ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¯­æ–™åº“ä¸­student open there book æ˜¯400æ¬¡æ¯” student open their examsæ˜¯100æ¬¡ï¼Œæ‰€ä»¥4-gram LMé€‰æ‹©bookä¸ºwã€‚
ä½†æ˜¯å¦‚æœè”ç³»æ›´å‰é¢çš„ä¸Šæ–‡ï¼Œæˆ‘ä»¬çŸ¥é“proctoræ˜¯ç›‘è€ƒå‘˜ï¼Œæ‰€ä»¥åº”è¯¥é€‰æ‹©examã€‚è¿™æ˜¯n-gramçš„é—®é¢˜ä¹‹ä¸€ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è®¨è®ºn-gramçš„é—®é¢˜ï¼š

#### é—®é¢˜1: ç¨€ç–æ€§é—®é¢˜ (Sparsity Problems)
é—®é¢˜1: å¦‚æœåˆ†å­ä»æ¥æ²¡æœ‰å‡ºç°è¿‡æ€ä¹ˆåŠï¼Ÿ
$$P(w|\text{students opened their})=\frac{\mathrm{count}(\text{students opened their }w)}{\mathrm{count}(\text{students opened their})}=0$$
å¼•å…¥ **å¹³æ»‘æŠ€æœ¯ (Smoothing)**ï¼Œä»è€Œè®©æ¨¡å‹å¯ä»¥å¤„ç†æ‰€æœ‰åˆ†å­ä¸å­˜åœ¨çš„æƒ…å†µã€‚
$$\mathrm{count}(w)\to\mathrm{count}(w)+\delta $$
é—®é¢˜2: å¦‚æœåˆ†æ¯ä»æ¥æ²¡æœ‰å‡ºç°è¿‡æ€ä¹ˆåŠï¼Ÿ
$$P(w|\text{students opened their})=\frac{\mathrm{count}(\text{students opened their }w)}{\mathrm{count}(\text{students opened their})}=\frac{?}0$$
å¯ä»¥ç”¨**backoff**ç­–ç•¥ã€‚å›é€€ä¸Šä¸‹æ–‡ã€‚
$$P(w|\text{students opened their})\approx P(w|\text{opened their})$$
å®é™…ä¸Šï¼Œn è¶Šå¤§ï¼Œn-gram çš„ç»„åˆæ•°é‡å‘ˆæŒ‡æ•°å¢é•¿ï¼Œå¯¼è‡´æ•°æ®ç¨€ç–æ€§åŠ å‰§ã€‚é€šå¸¸n ä¸ä¼šå–å¤ªå¤§å€¼ï¼ˆé€šå¸¸ä¸è¶…è¿‡ 5ï¼‰ï¼Œå¦åˆ™æ¨¡å‹çš„ç¨€ç–æ€§é—®é¢˜ä¼šéš¾ä»¥è§£å†³ã€‚

#### é—®é¢˜2: å‚¨å­˜é—®é¢˜(Storage Problems)
å¦‚æœä½ çš„è¯­æ–™åº“æœ‰Vä¸ªè¯ï¼Œé‚£ä¹ˆå¯èƒ½çš„n-gramå°±æœ‰ $V^n$ ç§ï¼Œé‚£ä¹ˆVå˜å¤§ï¼Œéœ€è¦å­˜å‚¨çš„æ¨¡å¼å°±æ›´å¤šã€‚

å®é™…ä¸­ï¼Œä¸€ä¸ª3-gramçš„LMçš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š

> today the price of gold per ton , while production of shoe lasts and shoe industry , the bank intervened just after it considered and rejected an imf demand to rebuild depleted european stocks , sept 30 end primary 76 cts a share .

è¯­æ³•å¤§æ¦‚æ²¡é—®é¢˜ï¼Œä½†æ˜¯ä¸è¿è´¯ï¼Œæ‰€ä»¥è€ƒè™‘æƒ³è¦ç”¨ç¥ç»ç½‘ç»œã€‚


### Fixed-window Neural Language Model
æ— ç¨€ç–æ€§é—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰å­˜å‚¨é—®é¢˜ã€‚
ä½†æœ‰æ–°é—®é¢˜ï¼šçª—å£æ°¸è¿œä¸å¤Ÿå¤§ï¼Œä¸”ç”±äºæ¯ä¸ªè¯åœ¨çš„ä½ç½®ä¸ä¸€æ ·ï¼Œæ¯ä¸ªè¯è¢«å¤„ç†çš„æƒé‡ä¹Ÿä¸ä¸€æ ·ï¼Œè¿™ä¸ä¸€å®šæ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯åœ¨è¿™é‡Œæä¸€ä¸‹ã€‚
![](assets/Pasted%20image%2020241121205107.webp)
### RNN
ä»¥å‰å­¦è¿‡ï¼Œè¿™é‡Œç®€å•èŠä¸€ä¸‹ã€‚é¦–å…ˆå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š

![](assets/Pasted%20image%2020241121205521.webp)
RNNä¼˜ç‚¹ï¼šä»»æ„é•¿åº¦éƒ½å¯ä»¥å¤„ç†ï¼Œä¸”æ‰€æœ‰é•¿åº¦çš„Wç»´åº¦éƒ½ä¸€æ ·ã€‚æ¯ä¸ªæ—¶é—´æ­¥è¯çš„å¤„ç†éƒ½æ˜¯å¯¹ç§°çš„ã€‚
ç¼ºç‚¹ï¼šæ…¢ï¼Œä¸”éš¾ä»¥åˆ©ç”¨å¾ˆé•¿æ—¶é—´æ­¥ä»¥å‰çš„å†…å®¹ã€‚è¿™äº›ç¼ºç‚¹å°†ä¼šåœ¨åé¢è¯¦è°ˆã€‚


#### å¦‚ä½•è®­ç»ƒRNNï¼Ÿ
æ‹¿ä¸€ä¸ªå¤§æ–‡å­—è¯­æ–™åº“ $\boldsymbol{x}^{(1)},\ldots,\boldsymbol{x}^{(T)}$ å–‚ç»™RNN, å¾—åˆ°æ¯ä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºåˆ†å¸ƒ $\hat{y}^{(t)}$ , $\hat{y}^{(t)}$ å‘é‡çš„æ¯ä¸€ä½éƒ½æ˜¯ä¸€ä¸ªæ¦‚ç‡ã€‚
ç„¶åå’Œground truth, one-hotå‘é‡ $y^{(t)}$ ç®—cross-entropy:
$$J^{(t)}(\theta)=CE(\boldsymbol{y}^{(t)},\hat{\boldsymbol{y}}^{(t)})=-\sum_{w\in V}\boldsymbol{y}_w^{(t)}\log\hat{\boldsymbol{y}}_w^{(t)}=-\log\hat{\boldsymbol{y}}_{\boldsymbol{x}_{t+1}}^{(t)}$$
è€Œæ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„losså°±æ˜¯è¿™æ ·ï¼š
$$J(\theta)=\frac1T\sum_{t=1}^TJ^{(t)}(\theta)=\frac1T\sum_{t=1}^T-\log\hat{\boldsymbol{y}}_{\boldsymbol{x}_{t+1}}^{(t)}$$
è®­ç»ƒçš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š
![](assets/Pasted%20image%2020241121232526.webp)

è¿™é‡Œé¢å­˜åœ¨ä¸€ä¸ªå«Teaching Forcingçš„æŠ€å·§ï¼Œæˆ–è€…å«è®­ç»ƒä¸æµ‹è¯•çš„å·®è·ï¼š
å°±æ¯”å¦‚è¯´ï¼Œå½“æˆ‘ä»¬ç»™å‡ºtheè¿™ä¸ªè¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¾“å‡ºçš„ä¸œè¥¿æ˜¯y1hat, è¾“å‡ºçš„hidden stateæ˜¯h1ï¼Œä½†æ˜¯é—®é¢˜å°±æ˜¯ï¼ŒçœŸå®åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬åº”å½“æ‹¿y1hatä½œä¸ºx2è¾“å…¥ï¼Œè€Œä¸æ˜¯ground truth x2ï¼Œstudentsã€‚åœ¨è¿™é‡Œè¾“å…¥ground truth xå¯ä»¥å¿«é€Ÿå¸®åŠ©æ¨¡å‹è®­ç»ƒï¼Œé˜²æ­¢é”™è¯¯ç´¯ç§¯ï¼Œå¯¼è‡´æ¨¡å‹è®­ç»ƒä¸ç¨³å®šã€‚
**ä½†Teaching Forthå…¶å®ä¹Ÿå­˜åœ¨æ½œåœ¨é—®é¢˜ã€‚** åœ¨æµ‹è¯•é˜¶æ®µï¼Œæ¨¡å‹éœ€è¦ä½¿ç”¨è‡ªå·±é¢„æµ‹çš„ç»“æœä½œä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥ï¼Œè¿™å¯èƒ½ä¸è®­ç»ƒé˜¶æ®µçš„è¡Œä¸ºä¸ä¸€è‡´ï¼Œä»è€Œå½±å“æ€§èƒ½ã€‚

[test1121](test1121.pdf)
